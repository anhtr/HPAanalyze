<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>HPAanalyze quick start guide: Acquire and visualize the Human Protein Atlas (HPA) data in one function â€¢ HPAanalyze</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="HPAanalyze quick start guide: Acquire and visualize the Human Protein Atlas (HPA) data in one function">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">HPAanalyze</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.3.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/HPAanalyze_case_images.html">HPAanalyze use case: Download histology images from the Human Protein Atlas</a>
    </li>
    <li>
      <a href="../articles/HPAanalyze_case_json.html">HPAanalyze use case: Export Human Protein Atlas (HPA) data as JSON</a>
    </li>
    <li>
      <a href="../articles/HPAanalyze_case_offline_xml.html">HPAanalyze use case: Working with Human Protein Atlas (HPA) xml files offline</a>
    </li>
    <li>
      <a href="../articles/HPAanalyze_case_query.html">HPAanalyze use case: Combine with your Human Protein Atlas (HPA) queries</a>
    </li>
    <li>
      <a href="../articles/HPAanalyze_indepth.html">2. HPAanalyze in-depth: Working with Human Protein Atlas (HPA) data in R</a>
    </li>
    <li>
      <a href="../articles/HPAanalyze_paper_figures.html">Code for figures from HPAanalyze paper</a>
    </li>
    <li>
      <a href="../articles/HPAanalyze_quick_start.html">HPAanalyze quick start guide: Acquire and visualize the Human Protein Atlas (HPA) data in one function</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>HPAanalyze quick start guide: Acquire and visualize the Human Protein Atlas (HPA) data in one function</h1>
                        <h4 class="author">Anh N. Tran</h4>
            <address class="author_afil">
      Northwestern University, Illinois, USA<br><a class="author_email" href="mailto:#"></a><a href="mailto:trannhatanh89@gmail.com" class="email">trannhatanh89@gmail.com</a>
      </address>
                  
            <h4 class="date">6/7/2019</h4>
      
      
      <div class="hidden name"><code>HPAanalyze_quick_start.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(BiocStyle)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(HPAanalyze)</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(dplyr)</a></code></pre></div>
<div id="background" class="section level1">
<h1 class="hasAnchor">
<a href="#background" class="anchor"></a>Background</h1>
<p>The Human Protein Atlas (HPA) is a comprehensive resource for exploration of human proteome which contains a vast amount of proteomics and transcriptomics data generated from antibody-based tissue micro-array profiling and RNA deep-sequencing.</p>
<p>The program has generated protein expression profiles in human normal tissues with cell type-specific expression patterns, cancer and cell lines via an innovative immunohistochemistry-based approach. These profiles are accompanied by a large collection of high quality histological staining images, annotated with clinical data and quantification. The database also includes classification of protein into both functional classes (such as transcription factors or kinases) and project-related classes (such as candidate genes for cancer). Starting from version 4.0, the HPA includes subcellular location profiles generated based on confocal images of immunofluorescent stained cells. Together, these data provide a detailed picture of protein expression in human cells and tissues, facilitating tissue-based diagnostic and research.</p>
<p>Data from the HPA are freely available via proteinatlas.org, allowing scientists to access and incorporate the data into their research. Previously, the R package <em>hpar</em> has been created for fast and easy programmatic access of HPA data. Here, we introduce <em>HPAanalyze</em>, an R package aims to simplify exploratory data analysis from those data, as well as provide other complementary functionality to <em>hpar</em>.</p>
<div id="the-different-hpa-data-formats" class="section level2">
<h2 class="hasAnchor">
<a href="#the-different-hpa-data-formats" class="anchor"></a>The different HPA data formats</h2>
<p>The Human Protein Atlas project provides data via two main mechanisms: <em>Full datasets</em> in the form of downloadable compressed tab-separated files (.tsv) and <em>individual entries</em> in XML, RDF and TSV formats. The full downloadable datasets includes normal tissue, pathology (cancer), subcellular location, RNA gene and RNA isoform data. For individual entries, the XML format is the most comprehensive, providing information on the target protein, antibodies, summary for each tissue and detailed data from each sample including clinical data, IHC scoring and image download links.</p>
</div>
<div id="hpaanalyze-overview" class="section level2">
<h2 class="hasAnchor">
<a href="#hpaanalyze-overview" class="anchor"></a><code>HPAanalyze</code> overview</h2>
<p><code>HPAanalyze</code> is designed to fullfill 3 main tasks: (1) Import, subsetting and export downloadable datasets; (2) Visualization of downloadable datasets for exploratory analysis; and (3) Working with the individual XML files. This package aims to serve researchers with little programming experience, but also allow power users to use the imported data as desired.</p>
</div>
</div>
<div id="visualize-protein-expression-data" class="section level1">
<h1 class="hasAnchor">
<a href="#visualize-protein-expression-data" class="anchor"></a>Visualize protein expression data</h1>
<p>Currently, this is available for the normal tissue, pathology (cancers) and subcellular location datasets. The fastest and easiest way is to use the defaults of <code>hpaVis</code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw"><a href="../reference/hpaVis.html">hpaVis</a></span>(<span class="dt">targetGene =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"GCH1"</span>, <span class="st">"PTS"</span>, <span class="st">"SPR"</span>, <span class="st">"DHFR"</span>),</a>
<a class="sourceLine" id="cb2-2" title="2">       <span class="dt">targetTissue =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"cerebellum"</span>, <span class="st">"cerebral cortex"</span>, <span class="st">"hippocampus"</span>),</a>
<a class="sourceLine" id="cb2-3" title="3">       <span class="dt">targetCancer =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"glioma"</span>))</a>
<a class="sourceLine" id="cb2-4" title="4"><span class="co">#&gt; No data provided. Use version 18.</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="co">#&gt; targetCellType variable not specified, visualize all.</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="co">#&gt; targetCellType variable not specified, visualize all.</span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="co">#&gt; Use hpaListParam() to list possible values for target variables.</span></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="co">#&gt; Use hpaListParam() to list possible values for target variables.</span></a></code></pre></div>
<p><img src="HPAanalyze_quick_start_files/figure-html/hpaVis_eg-1.png" width="700"></p>
<p>Of course, we cannot visualize everything in those big datasets, so some defauts will be used and you will receive some warning messages.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw"><a href="../reference/hpaVis.html">hpaVis</a></span>()</a>
<a class="sourceLine" id="cb3-2" title="2"></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="co"># No data provided. Use version 18.</span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="co"># targetGene variable not specified, default to TP53, RB1, MYC, KRAS and EGFR.</span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="co"># targetTissue variable not specified, default to breast.</span></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="co"># targetCellType variable not specified, visualize all.</span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="co"># targetCancer variable not specified, default to breast cancer</span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="co"># Use hpaListParam() to list possible values for target variables.</span></a></code></pre></div>
<p>You can also use <code>hpaVis</code> to show just one or two of the three graphs.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw"><a href="../reference/hpaVis.html">hpaVis</a></span>(<span class="dt">visType =</span> <span class="st">"Patho"</span>,</a>
<a class="sourceLine" id="cb4-2" title="2">       <span class="dt">targetGene =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"GCH1"</span>, <span class="st">"PTS"</span>, <span class="st">"SPR"</span>, <span class="st">"DHFR"</span>),</a>
<a class="sourceLine" id="cb4-3" title="3">       <span class="dt">targetCancer =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"glioma"</span>, <span class="st">"breast cancer"</span>))</a>
<a class="sourceLine" id="cb4-4" title="4"><span class="co">#&gt; No data provided. Use version 18.</span></a></code></pre></div>
<p><img src="HPAanalyze_quick_start_files/figure-html/hpaVis_eg3-1.png" width="700"></p>
<p>One exception though, if you want to plot all cancers, use <code>hpaVisPatho</code> with <code>targetCancer = NULL</code> (default).</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw"><a href="../reference/hpaVisPatho.html">hpaVisPatho</a></span>(<span class="dt">targetGene =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"GCH1"</span>, <span class="st">"PTS"</span>, <span class="st">"SPR"</span>, <span class="st">"DHFR"</span>))</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="co">#&gt; No data provided. Use version 18.</span></a></code></pre></div>
<p><img src="HPAanalyze_quick_start_files/figure-html/hpaVisPatho_eg-1.png" width="700"></p>
<p>There are many ways you could customize your plots. Please see the documentation for more details.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">?hpaVis <span class="co"># the easy umbrella to visualize protein expression levels</span></a>
<a class="sourceLine" id="cb6-2" title="2">?hpaVisTissue <span class="co"># in normal tissue</span></a>
<a class="sourceLine" id="cb6-3" title="3">?hpaVisSubcell <span class="co"># in subcellular compartments</span></a>
<a class="sourceLine" id="cb6-4" title="4">?hpaVisPatho <span class="co"># in cancers</span></a></code></pre></div>
<p>If you want to know what kind of data you can visualize, use <code>hpaListParam</code>. You will receive a list of parameters you can use. Please note that if you ask the functions to plot anything that is not on this list, they will just ignore it and plot what are available.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw"><a href="../reference/hpaListParam.html">hpaListParam</a></span>()</a></code></pre></div>
<pre><code>#&gt; No data provided. Use version 18.
#&gt; List of 4
#&gt;  $ normal_tissue       : chr [1:58] "adrenal gland" "appendix" "bone marrow" "breast" ...
#&gt;  $ normal_cell         : chr [1:82] "glandular cells" "lymphoid tissue" "hematopoietic cells" "adipocytes" ...
#&gt;  $ cancer              : chr [1:20] "breast cancer" "carcinoid" "cervical cancer" "colorectal cancer" ...
#&gt;  $ subcellular_location: chr [1:32] "Cytosol" "Mitochondria" "Aggresome" "Plasma membrane" ...</code></pre>
</div>
<div id="acquiring-individual-sample-data-from-the-human-protein-atlas" class="section level1">
<h1 class="hasAnchor">
<a href="#acquiring-individual-sample-data-from-the-human-protein-atlas" class="anchor"></a>Acquiring individual sample data from the Human Protein Atlas</h1>
<p>HPA provide data in two different formats: the more convenient summarized data tables that are used for the <code>hpaVis</code> functions above, and detailed annotated data for every sample and every antibody in the xml format. There is one xml for each protein, which contain all data generated by HPA. However, extracting information from these xml files into a tidy format is a challenge. The <code>hpaXml</code> functions are designed to help you easily access this.</p>
<p>The easiest way is to use the umbrella <code><a href="../reference/hpaXml.html">hpaXml()</a></code> function. Please note that at the moment this function only accept Ensembl gene id.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">EGFR &lt;-<span class="st"> </span><span class="kw"><a href="../reference/hpaXml.html">hpaXml</a></span>(<span class="dt">inputXml=</span><span class="st">'ENSG00000146648'</span>)</a>
<a class="sourceLine" id="cb9-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(EGFR)</a>
<a class="sourceLine" id="cb9-3" title="3"></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="co">#&gt; [1] "ProtClass"     "TissueExprSum" "Antibody"      "TissueExpr"   </span></a></code></pre></div>
<p>This function will return a list. The first item <code>ProtClass</code> is the known and predicted class of the queried protein. The second item <code>TissueExprSum</code> give you the quick summary of protein expression in normal tissue and image url to download one representative image. The third item <code>Antibody</code> provide information on all antibodied used by HPA to stain for the queried protein.</p>
<p>The last item <code>TissueExpr</code> is a list of data frame, one for each of the antibodies. Each row will have everything available regarding a sample stained with an antibody (clinical data, protein expression via IHC and the Url to download the original image). If you find an empty data frame, that means the antibody was used only for IF staining to determine subcellular locations. Currently HPAanalyze does not support extraction of that data.</p>
<p>To better understand the output, please read the documentation for other <code>hpaXml</code> functions, which was called under the hood by <code><a href="../reference/hpaXml.html">hpaXml()</a></code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">?hpaXmlGet <span class="co"># import the xml file as "xml_document"</span></a>
<a class="sourceLine" id="cb10-2" title="2">?hpaXmlProtClass</a>
<a class="sourceLine" id="cb10-3" title="3">?hpaXmlTissueExprSum</a>
<a class="sourceLine" id="cb10-4" title="4">?hpaXmlAntibody</a>
<a class="sourceLine" id="cb10-5" title="5">?hpaXmlTissueExpr</a></code></pre></div>
</div>
<div id="copyright" class="section level1">
<h1 class="hasAnchor">
<a href="#copyright" class="anchor"></a>Copyright</h1>
<p>Anh Tran, 2018</p>
<p>Please cite: <strong>Tran AN, Dussaq AM, Kennell T, Willey C, Hjelmeland A. <em>HPAanalyze: An R Package that Facilitates the Retrieval and Analysis of The Human Protein Atlas Data</em>. bioRxiv 355032; doi: <a href="https://doi.org/10.1101/355032" class="uri">https://doi.org/10.1101/355032</a> </strong></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#background">Background</a><ul class="nav nav-pills nav-stacked">
<li><a href="#the-different-hpa-data-formats">The different HPA data formats</a></li>
      <li><a href="#hpaanalyze-overview"><code>HPAanalyze</code> overview</a></li>
      </ul>
</li>
      <li><a href="#visualize-protein-expression-data">Visualize protein expression data</a></li>
      <li><a href="#acquiring-individual-sample-data-from-the-human-protein-atlas">Acquiring individual sample data from the Human Protein Atlas</a></li>
      <li><a href="#copyright">Copyright</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Anh Nhat Tran.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
